html
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ðŸ’„ MaquillARte â€” Realidad Aumentada</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

  <style>
    /* === ESTÃ‰TICA AZUL-VIOLETA MODERNA === */
    body {
      margin: 0;
      padding: 0;
      font-family: 'Poppins', sans-serif;
      overflow: hidden;
      text-align: center;
      background: radial-gradient(circle at 30% 30%, #3b1a73 0%, #150b3e 60%, #07041f 100%);
      color: #ffffff;
      height: 100vh;
    }

    h1 {
      position: relative;
      font-size: 36px;
      font-weight: 600;
      margin: 25px 0 15px;
      color: #ffffff;
      text-shadow: 0 0 12px rgba(255, 255, 255, 0.15);
      letter-spacing: 0.5px;
      z-index: 2;
    }

    video, canvas#canvas {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 20px;
      width: 70vw;
      height: auto;
      box-shadow: 0 0 40px rgba(90, 60, 255, 0.4);
      z-index: 1;
    }

    /* === PANEL DE CONTROLES === */
    .controls {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      background: rgba(255, 255, 255, 0.08);
      padding: 18px 30px;
      border-radius: 20px;
      backdrop-filter: blur(15px);
      box-shadow: 0 0 20px rgba(138, 228, 255, 0.2);
      align-items: center;
      border: 1px solid rgba(180, 180, 255, 0.2);
      z-index: 3;
    }

    .group {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }

    .group label {
      color: #ffffff;
      font-size: 14px;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      font-weight: 500;
    }

    .swatches {
      display: flex;
      gap: 8px;
    }

    .color-btn {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      border: 2px solid #fff;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 0 10px rgba(255,255,255,0.1);
    }

    .color-btn:hover {
      transform: scale(1.15);
      box-shadow: 0 0 10px rgba(138, 228, 255, 0.6);
    }

    button#reset {
      padding: 10px 14px;
      border-radius: 12px;
      background: linear-gradient(135deg, #6b5bff, #00f0ff);
      color: #fff;
      border: none;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      font-weight: 500;
      transition: 0.3s ease;
      box-shadow: 0 0 15px rgba(0, 240, 255, 0.4);
    }

    button#reset:hover {
      transform: scale(1.05);
      box-shadow: 0 0 25px rgba(0, 240, 255, 0.8);
    }

    /* === AJUSTES RESPONSIVOS PARA MÃ“VILES === */
    @media (max-width: 768px) {
      body {
        overflow: auto;
        height: auto;
      }

      video, canvas#canvas {
        position: relative;
        top: auto;
        left: auto;
        transform: none;
        width: 100vw;
        height: auto;
        border-radius: 0;
        box-shadow: none;
      }

      h1 {
        font-size: 24px;
        margin: 12px 0;
      }

      .controls {
        position: relative;
        bottom: auto;
        left: 0;
        transform: none;
        width: 100%;
        flex-direction: column;
        gap: 12px;
        background: rgba(255, 255, 255, 0.1);
        padding: 12px 0;
        border-radius: 0;
        box-shadow: none;
        border: none;
      }

      .group {
        flex-direction: row;
        justify-content: center;
        gap: 8px;
      }

      button#reset {
        margin-top: 8px;
      }
    }
  </style>
</head>

<body>
  <h1>ðŸ’„ MaquillARte â€” Realidad Aumentada</h1>

  <video id="video" autoplay playsinline></video>
  <canvas id="canvas"></canvas>

  <div class="controls">
    <div class="group">
      <label>Labial</label>
      <div id="labialSwatches" class="swatches"></div>
    </div>
    <div class="group">
      <label>Rubor</label>
      <div id="ruborSwatches" class="swatches"></div>
    </div>
    <div class="group">
      <label>Sombra</label>
      <div id="sombrasSwatches" class="swatches"></div>
    </div>
    <div class="group">
      <label>Cejas</label>
      <div id="cejasSwatches" class="swatches"></div>
    </div>
    <button id="reset">Reiniciar maquillaje</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>

  <script>
    const video = document.getElementById("video");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    let labialColor = "", ruborColor = "", sombrasColor = "", cejasColor = "";
    let keypoints = null;

    const ajustes = {
      ruborIzq: { xOffset: -0.015, yOffset: 0.015, scale: 1 },
      ruborDer: { xOffset: 0.015, yOffset: 0.015, scale: 1 },
      sombraIzq: { xOffset: 0, yOffset: -0.014, scale: 1 },
      sombraDer: { xOffset: 0, yOffset: -0.014, scale: 1 },
      labial: { xOffset: 0, yOffset: 0, scale: 1 },
      cejas: { xOffset: 0, yOffset: 0, scale: 1 }
    };

    const paletas = {
      labiales: ["#c58b7b", "#e07b91", "#b43737"],
      rubores: ["#f7a18f", "#f3b3b3", "#d68ca3"],
      sombras: ["#d6c3a1", "#a0785a", "#8b8680"],
      cejas: ["#9b7355", "#6b4c3b", "#3e2d25"]
    };

    function crearSwatches(colores, id, cb) {
      const cont = document.getElementById(id);
      cont.innerHTML = "";
      colores.forEach(c => {
        const btn = document.createElement("button");
        btn.className = "color-btn";
        btn.style.backgroundColor = c;
        btn.onclick = () => { cb(c); markSelected(btn, cont); };
        cont.appendChild(btn);
      });
    }

    function markSelected(btn, cont) {
      Array.from(cont.children).forEach(b => b.style.outline = "none");
      btn.style.outline = "3px solid rgba(138, 228, 255, 0.8)";
      btn.style.boxShadow = "0 0 10px rgba(138, 228, 255, 0.7)";
    }

    crearSwatches(paletas.labiales, "labialSwatches", c => labialColor = c);
    crearSwatches(paletas.rubores, "ruborSwatches", c => ruborColor = c);
    crearSwatches(paletas.sombras, "sombrasSwatches", c => sombrasColor = c);
    crearSwatches(paletas.cejas, "cejasSwatches", c => cejasColor = c);

    document.getElementById("reset").addEventListener("click", () => {
      labialColor = ruborColor = sombrasColor = cejasColor = "";
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    });

    async function startCamera() {
      const stream = await navigator.mediaDevices.getUserMedia({
        video: { width: 1280, height: 720 }
      });
      video.srcObject = stream;
    }

    const faceMesh = new FaceMesh({
      locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${file}`
    });
    faceMesh.setOptions({ maxNumFaces: 1, refineLandmarks: true });
    faceMesh.onResults(onResults);

    async function onResults(results) {
      if (!results || !results.image) return;
      canvas.width = video.videoWidth || results.image.width;
      canvas.height = video.videoHeight || results.image.height;
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(results.image, 0, 0, canvas.width, canvas.height);

      if (!results.multiFaceLandmarks) return;
      keypoints = results.multiFaceLandmarks[0];
      if (!keypoints || keypoints.length < 400) return;

      if (labialColor) drawLabios(labialColor);
      if (ruborColor) drawRubor(ruborColor);
      if (sombrasColor) drawSombras(sombrasColor);
      if (cejasColor) drawCejas(cejasColor);
    }

    function drawLabios(color) {
      const upper = [61,185,40,39,37,0,267,269,270,409,291];
      const lower = [61,146,91,181,84,17,314,405,321,375,291];
      drawRegion(upper.concat(lower), color, 0.6);
    }

    function drawRubor(color) {
      const left = keypoints[50];
      const right = keypoints[280];
      drawSoftOval(left, 45, 45, color, 0.35, ajustes.ruborIzq);
      drawSoftOval(right, 45, 45, color, 0.35, ajustes.ruborDer);
    }

    function drawSombras(color) {
      const left = keypoints[159];
      const right = keypoints[386];
      drawSoftOval(left, 60, 35, color, 0.4, ajustes.sombraIzq);
      drawSoftOval(right, 60, 35, color, 0.4, ajustes.sombraDer);
    }

    function drawCejas(color) {
      const leftBrow = [55,107,66,105,63,70,46,53,52,65];
      const rightBrow = [285,336,296,334,293,300,276,283,295];
      drawRegion(leftBrow, color, 0.5);
      drawRegion(rightBrow, color, 0.5);
    }

    function drawRegion(indices, color, alpha) {
      ctx.save();
      ctx.beginPath();
      let started = false;
      indices.forEach(i => {
        const p = keypoints[i];
        if (!p) return;
        const x = p.x * canvas.width;
        const y = p.y * canvas.height;
        if (!started) { ctx.moveTo(x, y); started = true; } else ctx.lineTo(x, y);
      });
      if (!started) { ctx.restore(); return; }
      ctx.closePath();
      ctx.fillStyle = color;
      ctx.globalAlpha = alpha;
      ctx.filter = "blur(2px)";
      ctx.fill();
      ctx.restore();
    }

    function drawSoftOval(point, radiusX, radiusY, color, alpha, ajuste) {
      const x = (point.x + (ajuste.xOffset || 0)) * canvas.width;
      const y = (point.y + (ajuste.yOffset || 0)) * canvas.height;
      const grad = ctx.createRadialGradient(x, y, 10, x, y, 60);
      grad.addColorStop(0, hexToRgba(color, alpha));
      grad.addColorStop(1, hexToRgba(color, 0));
      ctx.save();
      ctx.beginPath();
      ctx.ellipse(x, y, radiusX, radiusY, 0, 0, 2 * Math.PI);
      ctx.fillStyle = grad;
      ctx.filter = "blur(6px)";
      ctx.fill();
      ctx.restore();
    }

    function hexToRgba(hex, alpha) {
      const c = hex.replace('#','');
      const r = parseInt(c.substring(0,2),16);
      const g = parseInt(c.substring(2,4),16);
      const b = parseInt(c.substring(4,6),16);
      return `rgba(${r},${g},${b},${alpha})`;
    }

    startCamera();
    const camera = new Camera(video, {
      onFrame: async () => { await faceMesh.send({ image: video }); },
      width: 1280, height: 720
    });
    camera.start();
  </script>
</body>
</html>
